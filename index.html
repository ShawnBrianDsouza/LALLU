<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Water Bottle Puzzle (8L,5L,3L)</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, #131726 0, #03040a 65%);
      color: #f7f7f7;
    }

    .game-container {
      width: min(900px, 95vw);
      padding: 24px 22px 18px;
      border-radius: 20px;
      background: rgba(10, 12, 22, 0.96);
      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.85);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .header {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 16px;
      align-items: center;
    }

    .title {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .subtitle {
      font-size: 0.9rem;
      color: #a7b3d5;
      margin-top: 3px;
    }

    .stats {
      display: flex;
      gap: 10px;
      align-items: center;
      font-size: 0.9rem;
    }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: rgba(255, 255, 255, 0.02);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .pill .label {
      font-size: 0.8rem;
      color: #9fa9c9;
    }

    .pill .value {
      font-weight: 600;
    }

    .btn {
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      background: linear-gradient(135deg, #3551ff, #1d2a7a);
      color: #fff;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 500;
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.15s ease;
      white-space: nowrap;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.75);
      background: linear-gradient(135deg, #4f6dff, #2736a0);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .bottles-area {
      margin-top: 8px;
      display: flex;
      justify-content: space-around;
      gap: 20px;
      padding: 16px 10px 10px;
      border-radius: 18px;
      background: radial-gradient(circle at top, #131a32 0, #050814 75%);
      border: 1px solid rgba(255, 255, 255, 0.06);
    }

    .bottle-wrapper {
      flex: 1;
      max-width: 230px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }

    .bottle-label {
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: #dde6ff;
    }

    .bottle {
      --cap: 8; /* default, overridden inline */
      position: relative;
      width: 82px;
      height: calc(90px + var(--cap) * 16px); /* height proportional to capacity */
      border-radius: 32px 32px 20px 20px;
      border: 2px solid rgba(210, 225, 255, 0.8);
      background: linear-gradient(
        155deg,
        rgba(255, 255, 255, 0.15),
        rgba(255, 255, 255, 0.02)
      );
      overflow: hidden;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      box-shadow:
        0 14px 25px rgba(0, 0, 0, 0.8),
        inset 0 0 18px rgba(255, 255, 255, 0.12);
      transition: transform 0.15s ease, box-shadow 0.15s ease,
        border-color 0.15s ease;
    }

    .bottle::before {
      /* neck */
      content: "";
      position: absolute;
      top: -22px;
      left: 50%;
      transform: translateX(-50%);
      width: 32px;
      height: 22px;
      border-radius: 10px 10px 6px 6px;
      border: 2px solid rgba(210, 225, 255, 0.9);
      border-bottom: none;
      background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.85),
        rgba(185, 204, 255, 0.25)
      );
      box-shadow: 0 -3px 6px rgba(0, 0, 0, 0.7);
    }

    .bottle::after {
      /* inner side highlight */
      content: "";
      position: absolute;
      top: 18%;
      bottom: 18%;
      left: 12px;
      width: 14px;
      border-radius: 999px;
      background: linear-gradient(
        180deg,
        rgba(255, 255, 255, 0.55),
        rgba(255, 255, 255, 0.05)
      );
      opacity: 0.45;
      pointer-events: none;
    }

    .bottle.selected {
      border-color: #00e5ff;
      box-shadow:
        0 0 20px rgba(0, 229, 255, 0.8),
        0 18px 30px rgba(0, 0, 0, 0.9);
      transform: translateY(-4px) scale(1.02);
    }

    .bottle-target {
      outline: 2px dashed rgba(0, 229, 255, 0.5);
      outline-offset: 4px;
    }

    .water {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 0;
      background: linear-gradient(
        180deg,
        rgba(0, 195, 255, 0.95),
        rgba(0, 110, 255, 0.96)
      );
      box-shadow: 0 0 22px rgba(0, 185, 255, 0.9);
      transition: height 0.32s ease-in-out;
    }

    .water::before {
      /* ripple */
      content: "";
      position: absolute;
      top: -5px;
      left: 10px;
      right: 10px;
      height: 10px;
      border-radius: 50%;
      background: radial-gradient(
        ellipse at center,
        rgba(255, 255, 255, 0.95),
        rgba(255, 255, 255, 0)
      );
      opacity: 0.9;
      filter: blur(2px);
    }

    .volume-text {
      position: absolute;
      top: 8px;
      right: 8px;
      font-size: 0.75rem;
      background: rgba(0, 0, 0, 0.6);
      padding: 3px 7px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .capacity-text {
      font-size: 0.8rem;
      color: #97a1c2;
    }

    .footer {
      margin-top: 14px;
      padding-top: 10px;
      border-top: 1px dashed rgba(255, 255, 255, 0.15);
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
      font-size: 0.86rem;
    }

    .message {
      color: #a7b3cf;
    }

    .message.win {
      color: #3ee5a7;
      font-weight: 600;
    }

    .instructions {
      color: #858fb2;
      max-width: 460px;
      line-height: 1.4;
    }

    @media (max-width: 650px) {
      .bottle {
        width: 70px;
      }
      .game-container {
        padding-inline: 16px;
      }
    }

    @media (max-width: 520px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }
      .footer {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="header">
      <div>
        <div class="title">Water Bottle Puzzle</div>
        <div class="subtitle">
          Goal: Bottle A = 4 L, Bottle B = 4 L, Bottle C = 0 L
        </div>
      </div>
      <div class="stats">
        <div class="pill">
          <span class="label">Moves</span>
          <span class="value" id="moves">0</span>
        </div>
        <button class="btn" id="resetBtn">Reset</button>
      </div>
    </div>

    <div class="bottles-area">
      <!-- Bottle A (8 L, tallest) -->
      <div class="bottle-wrapper" data-index="0">
        <div class="bottle-label">Bottle A</div>
        <div class="bottle" id="bottle-0" style="--cap:8;">
          <div class="water" id="water-0"></div>
          <div class="volume-text" id="volume-0">0 L</div>
        </div>
        <div class="capacity-text">Capacity: 8 L</div>
      </div>

      <!-- Bottle B (5 L, medium) -->
      <div class="bottle-wrapper" data-index="1">
        <div class="bottle-label">Bottle B</div>
        <div class="bottle" id="bottle-1" style="--cap:5;">
          <div class="water" id="water-1"></div>
          <div class="volume-text" id="volume-1">0 L</div>
        </div>
        <div class="capacity-text">Capacity: 5 L</div>
      </div>

      <!-- Bottle C (3 L, smallest) -->
      <div class="bottle-wrapper" data-index="2">
        <div class="bottle-label">Bottle C</div>
        <div class="bottle" id="bottle-2" style="--cap:3;">
          <div class="water" id="water-2"></div>
          <div class="volume-text" id="volume-2">0 L</div>
        </div>
        <div class="capacity-text">Capacity: 3 L</div>
      </div>
    </div>

    <div class="footer">
      <div class="instructions">
        Tap a bottle to select it (source). Then tap another bottle to pour into it.
        You canâ€™t overfill a bottle â€” pouring stops when the destination is full or
        the source is empty.
      </div>
      <div class="message" id="message">
        Ready! Start from A = 8 L, B = 0 L, C = 0 L.
      </div>
    </div>
  </div>

  <script>
    // --- Logic values ---
    const capacities = [8, 5, 3];
    let volumes = [8, 0, 0];
    const goal = [4, 4, 0];

    let selectedIndex = null;
    let moves = 0;

    const moveElem = document.getElementById("moves");
    const messageElem = document.getElementById("message");

    // --- Simple Web Audio-based sounds (no external files) ---
    const AudioContextClass = window.AudioContext || window.webkitAudioContext;
    let audioCtx = null;

    function getAudioCtx() {
      if (!audioCtx && AudioContextClass) {
        audioCtx = new AudioContextClass();
      }
      return audioCtx;
    }

    function playClickSound() {
      const ctx = getAudioCtx();
      if (!ctx) return;
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = "triangle";
      osc.frequency.value = 650;
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.09);
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.start();
      osc.stop(ctx.currentTime + 0.1);
    }

    function playPourSound(duration = 0.4) {
      const ctx = getAudioCtx();
      if (!ctx) return;
      const sampleRate = ctx.sampleRate;
      const buffer = ctx.createBuffer(1, sampleRate * duration, sampleRate);
      const data = buffer.getChannelData(0);

      // white-noise-ish "water" with envelope
      for (let i = 0; i < data.length; i++) {
        const t = i / data.length;
        const envelope = Math.sin(t * Math.PI); // fade in/out
        data[i] = (Math.random() * 2 - 1) * 0.4 * envelope;
      }

      const noise = ctx.createBufferSource();
      noise.buffer = buffer;
      const gain = ctx.createGain();
      gain.gain.value = 0.5;
      noise.connect(gain);
      gain.connect(ctx.destination);
      noise.start();
    }

    // --- UI handling ---

    function isGoalReached() {
      return (
        volumes[0] === goal[0] &&
        volumes[1] === goal[1] &&
        volumes[2] === goal[2]
      );
    }

    function clearSelection() {
      selectedIndex = null;
      document.querySelectorAll(".bottle").forEach((b) => {
        b.classList.remove("selected", "bottle-target");
      });
    }

    function updateUI() {
      volumes.forEach((vol, i) => {
        const water = document.getElementById("water-" + i);
        const volumeText = document.getElementById("volume-" + i);
        const bottle = document.getElementById("bottle-" + i);
        const capacity = capacities[i];

        const percent = (vol / capacity) * 100;
        water.style.height = percent + "%";
        volumeText.textContent = vol + " L";

        bottle.classList.remove("bottle-target");
      });

      moveElem.textContent = moves.toString();

      if (isGoalReached()) {
        messageElem.textContent = "Nice! You reached 4 L, 4 L, 0 L ðŸŽ‰";
        messageElem.classList.add("win");
      } else {
        messageElem.classList.remove("win");
        if (selectedIndex !== null) {
          messageElem.textContent =
            "Selected Bottle " +
            ["A", "B", "C"][selectedIndex] +
            " â€“ now tap another bottle to pour into.";
        } else {
          messageElem.textContent =
            "Tap a bottle to select it, then tap another to pour.";
        }
      }
    }

    function resetGame() {
      volumes = [8, 0, 0];
      moves = 0;
      clearSelection();
      updateUI();
    }

    function selectBottle(index) {
      playClickSound();
      const bottleElem = document.getElementById("bottle-" + index);

      if (selectedIndex === null) {
        selectedIndex = index;
        bottleElem.classList.add("selected");

        document.querySelectorAll(".bottle").forEach((b, i) => {
          if (i !== index) b.classList.add("bottle-target");
        });
        updateUI();
        return;
      }

      if (selectedIndex === index) {
        clearSelection();
        updateUI();
        return;
      }

      const source = selectedIndex;
      const dest = index;
      const amountSourceHas = volumes[source];
      const destSpace = capacities[dest] - volumes[dest];

      if (amountSourceHas === 0 || destSpace === 0) {
        clearSelection();
        selectBottle(index);
        return;
      }

      const pourAmount = Math.min(amountSourceHas, destSpace);

      if (pourAmount > 0) {
        volumes[source] -= pourAmount;
        volumes[dest] += pourAmount;
        moves += 1;
        playPourSound();
      }

      clearSelection();
      updateUI();
    }

    document.querySelectorAll(".bottle-wrapper").forEach((wrapper) => {
      wrapper.addEventListener("click", () => {
        const idx = parseInt(wrapper.getAttribute("data-index"), 10);
        selectBottle(idx);
      });
    });

    document.getElementById("resetBtn").addEventListener("click", resetGame);

    // Initial render
    updateUI();
  </script>
</body>
</html>
